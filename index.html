<!doctype html>
<html lang="fr" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ramadan + Running 2026 (JT)</title>

  <style>
    :root{
      --bg:#f4f7fb;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --primary:#4f46e5;
      --accent:#f59e0b;
      --border:#e5e7eb;
      --shadow:0 10px 25px rgba(0,0,0,.08);
    }
    [data-theme="dark"]{
      --bg:#0b1220;
      --card:#0f172a;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --primary:#6366f1;
      --accent:#fbbf24;
      --border:#1f2937;
      --shadow:0 10px 25px rgba(0,0,0,.35);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
      background:var(--bg);
      color:var(--text);
    }

    header{
      padding:18px 16px;
      background:linear-gradient(135deg,var(--primary),var(--accent));
      color:#fff;
    }
    header .subtitle{
      margin-top:6px;
      font-size:12px;
      opacity:.9;
    }

    main{
      padding:16px;
      max-width:980px;
      margin:0 auto;
    }

    .tabs{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin:12px 0 16px;
    }
    .tab{
      border:none;
      border-radius:999px;
      padding:10px 16px;
      font-weight:700;
      cursor:pointer;
      background:#e5e7eb;
      color:#111827;
    }
    [data-theme="dark"] .tab{ background:#111827; color:#e5e7eb; }
    .tab.active{
      background:var(--primary);
      color:#fff;
    }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      padding:16px;
      margin-bottom:16px;
      box-shadow:var(--shadow);
    }
    .h{
      font-weight:800;
      margin:0 0 8px;
      font-size:16px;
    }
    .small{
      font-size:12px;
      color:var(--muted);
      line-height:1.35;
    }
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
      gap:12px;
      margin-top:12px;
    }
    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-bottom:4px;
    }
    input[type="number"], input[type="text"], textarea, select{
      width:100%;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background:transparent;
      color:var(--text);
      outline:none;
    }
    textarea{min-height:80px; resize:vertical}

    /* ‚úÖ CHECKLIST (fix iPhone) */
    .check{
      display:flex;
      align-items:center;
      gap:10px;
      margin:10px 0;
    }
    .check input[type="checkbox"]{
      width:22px;
      height:22px;
      flex:0 0 22px;
    }
    .check label{
      margin:0;
      flex:1;            /* ‚úÖ emp√™che le texte de partir √† droite */
      cursor:pointer;    /* ‚úÖ clic sur le texte coche */
      font-size:14px;
      color:var(--text);
    }

    table{
      width:100%;
      border-collapse:collapse;
      overflow:hidden;
      border-radius:14px;
      border:1px solid var(--border);
    }
    th,td{
      padding:10px;
      border-bottom:1px solid var(--border);
      text-align:left;
      font-size:13px;
      vertical-align:top;
    }
    th{
      background:rgba(0,0,0,.03);
      color:var(--text);
      font-weight:800;
    }
    [data-theme="dark"] th{ background:rgba(255,255,255,.05); }

    .pillrow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:12px;
    }
    .pill{
      border:1px solid var(--border);
      background:transparent;
      color:var(--text);
      padding:10px 12px;
      border-radius:999px;
      font-weight:800;
      cursor:pointer;
    }
    .pill.active{
      background:var(--primary);
      border-color:var(--primary);
      color:#fff;
    }

    .toggle-theme{
      position:fixed;
      right:18px;
      bottom:18px;
      border:none;
      background:var(--primary);
      color:#fff;
      border-radius:999px;
      padding:14px 16px;
      font-weight:900;
      box-shadow:0 10px 25px rgba(0,0,0,.35);
      cursor:pointer;
    }

    .row{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      align-items:center;
      justify-content:space-between;
    }

    .warn{
      margin-top:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid #ef4444;
      color:#ef4444;
      font-size:12px;
      font-weight:800;
    }
  </style>
</head>

<body>
  <header>
    <div style="font-weight:900;font-size:18px;">Ramadan + Running 2026 ‚Äî Melesse (35520)</div>
    <div class="subtitle">Suivi quotidien ‚Ä¢ Programme annuel ‚Ä¢ Ramadan (horaires + repas) ‚Ä¢ Mode clair/sombre</div>
  </header>

  <main>
    <div class="tabs">
      <button class="tab active" data-tab="today">Aujourd‚Äôhui</button>
      <button class="tab" data-tab="log">Journal</button>
      <button class="tab" data-tab="program">Programme 2026</button>
      <button class="tab" data-tab="ramadan">Ramadan</button>
      <button class="tab" data-tab="settings">Objectifs</button>
    </div>

    <section id="today" class="panel"></section>
    <section id="log" class="panel" style="display:none;"></section>
    <section id="program" class="panel" style="display:none;"></section>
    <section id="ramadan" class="panel" style="display:none;"></section>
    <section id="settings" class="panel" style="display:none;"></section>
  </main>

  <button class="toggle-theme" onclick="toggleTheme()">üåô / ‚òÄÔ∏è</button>

  <script>
    /* =========================
       DATA
    ========================= */
    const DATA = {
      ramadanSchedule: [
        {"day":1,"date":"2026-02-19","fajr":"06:41","maghrib":"18:38","fasting":"11h57"},
        {"day":2,"date":"2026-02-20","fajr":"06:39","maghrib":"18:40","fasting":"12h01"},
        {"day":3,"date":"2026-02-21","fajr":"06:37","maghrib":"18:41","fasting":"12h04"},
        {"day":4,"date":"2026-02-22","fajr":"06:36","maghrib":"18:43","fasting":"12h07"},
        {"day":5,"date":"2026-02-23","fajr":"06:34","maghrib":"18:44","fasting":"12h10"},
        {"day":6,"date":"2026-02-24","fajr":"06:32","maghrib":"18:46","fasting":"12h14"},
        {"day":7,"date":"2026-02-25","fajr":"06:30","maghrib":"18:48","fasting":"12h18"},
        {"day":8,"date":"2026-02-26","fajr":"06:29","maghrib":"18:49","fasting":"12h20"},
        {"day":9,"date":"2026-02-27","fajr":"06:27","maghrib":"18:51","fasting":"12h24"},
        {"day":10,"date":"2026-02-28","fajr":"06:25","maghrib":"18:52","fasting":"12h27"},
        {"day":11,"date":"2026-03-01","fajr":"06:23","maghrib":"18:54","fasting":"12h31"},
        {"day":12,"date":"2026-03-02","fajr":"06:21","maghrib":"18:55","fasting":"12h34"},
        {"day":13,"date":"2026-03-03","fajr":"06:19","maghrib":"18:57","fasting":"12h38"},
        {"day":14,"date":"2026-03-04","fajr":"06:17","maghrib":"18:58","fasting":"12h41"},
        {"day":15,"date":"2026-03-05","fajr":"06:15","maghrib":"19:00","fasting":"12h45"},
        {"day":16,"date":"2026-03-06","fajr":"06:13","maghrib":"19:01","fasting":"12h48"},
        {"day":17,"date":"2026-03-07","fajr":"06:11","maghrib":"19:03","fasting":"12h52"},
        {"day":18,"date":"2026-03-08","fajr":"06:09","maghrib":"19:05","fasting":"12h56"},
        {"day":19,"date":"2026-03-09","fajr":"06:07","maghrib":"19:06","fasting":"12h59"},
        {"day":20,"date":"2026-03-10","fajr":"06:05","maghrib":"19:08","fasting":"13h03"},
        {"day":21,"date":"2026-03-11","fajr":"06:03","maghrib":"19:09","fasting":"13h06"},
        {"day":22,"date":"2026-03-12","fajr":"06:01","maghrib":"19:11","fasting":"13h10"},
        {"day":23,"date":"2026-03-13","fajr":"05:59","maghrib":"19:12","fasting":"13h13"},
        {"day":24,"date":"2026-03-14","fajr":"05:57","maghrib":"19:14","fasting":"13h17"},
        {"day":25,"date":"2026-03-15","fajr":"05:55","maghrib":"19:15","fasting":"13h20"},
        {"day":26,"date":"2026-03-16","fajr":"05:52","maghrib":"19:17","fasting":"13h25"},
        {"day":27,"date":"2026-03-17","fajr":"05:50","maghrib":"19:18","fasting":"13h28"},
        {"day":28,"date":"2026-03-18","fajr":"05:48","maghrib":"19:19","fasting":"13h31"},
        {"day":29,"date":"2026-03-19","fajr":"05:46","maghrib":"19:21","fasting":"13h35"},
        {"day":30,"date":"2026-03-20","fajr":"05:44","maghrib":"19:22","fasting":"13h38"}
      ],
      strengthKneeFriendly: [
        {name:"Gainage face", sets:3, reps:"30‚Äì45 s"},
        {name:"Gainage lat√©ral", sets:2, reps:"30 s / c√¥t√©"},
        {name:"Pont fessier", sets:3, reps:"15‚Äì20"},
        {name:"Mollets lents", sets:3, reps:"20"},
        {name:"Squat lent (amplitude contr√¥l√©e)", sets:3, reps:"10‚Äì12"}
      ]
    };

    /* =========================
       STORE
    ========================= */
    const store = {
      get(k, d){
        try { return JSON.parse(localStorage.getItem(k)) ?? d; }
        catch(e){ return d; }
      },
      set(k, v){ localStorage.setItem(k, JSON.stringify(v)); }
    };

    function z(n){ return String(n).padStart(2,'0'); }
    function fmtDate(d){ return `${d.getFullYear()}-${z(d.getMonth()+1)}-${z(d.getDate())}`; }

    /* theme init */
    (function initTheme(){
      const saved = store.get("theme", null);
      const t = saved || document.documentElement.getAttribute("data-theme") || "light";
      document.documentElement.setAttribute("data-theme", t);
    })();

    /* =========================
       GOALS / SETTINGS
    ========================= */
    const defaultGoals = { km:12, min:120, runs:2, kneeAlert:5, mode:"B" }; // A=plus vite, B=plus doux
    if(!store.get("goals", null)) store.set("goals", defaultGoals);

    /* =========================
       DAILY STATE (par date)
    ========================= */
    function getDaily(dateStr){
      const all = store.get("daily", {});
      return all[dateStr] || {
        hydration:false,
        course:false,
        renfo:false,
        minutes:"",
        km:"",
        knee:"",
        notes:""
      };
    }
    function setDaily(dateStr, st){
      const all = store.get("daily", {});
      all[dateStr] = st;
      store.set("daily", all);
    }

    /* =========================
       PHASES 2026 (simple, clair)
    ========================= */
    function getPhase(){
      const d = new Date();
      const rStart = new Date("2026-02-19T00:00:00");
      const rEnd   = new Date("2026-03-20T23:59:59");
      if(d < rStart) return "Reprise";
      if(d >= rStart && d <= rEnd) return "Ramadan";
      if(d <= new Date("2026-04-30T23:59:59")) return "Post-Ramadan";
      if(d <= new Date("2026-08-31T23:59:59")) return "Base endurance";
      if(d <= new Date("2026-11-30T23:59:59")) return "Objectif 10 km";
      return "Entretien";
    }

    function getOrientation(){
      const p = getPhase();
      const mode = store.get("goals", defaultGoals).mode;
      if(p==="Reprise") return "Marche / course ‚Äî 2 s√©ances ‚Äî priorit√© genou + r√©gularit√©";
      if(p==="Ramadan") return "Footing doux apr√®s Iftar ‚Äî 2 s√©ances max ‚Äî renfo l√©ger";
      if(p==="Post-Ramadan") return "Course continue ‚Äî progression douce ‚Äî 2 √† 3 s√©ances";
      if(p==="Base endurance") return mode==="A"
        ? "Endurance + sortie un peu plus longue ‚Äî mont√©e progressive"
        : "Endurance facile ‚Äî mont√©e progressive (plus prudente)";
      if(p==="Objectif 10 km") return "Endurance + allure ‚Äî objectif courir 10 km sans marche";
      return "Entretien ‚Äî 2 s√©ances faciles + mobilit√©";
    }

    /* =========================
       PROGRAMME MARCHE‚ÜíCOURSE (A/B)
       (objectif: courir 30 min sans marche)
    ========================= */
    const planA = [
      {w:1,  label:"6√ó (1' course / 2' marche) ‚Äî total ~18‚Äô"},
      {w:2,  label:"6√ó (2' course / 2' marche) ‚Äî total ~24‚Äô"},
      {w:3,  label:"6√ó (3' course / 2' marche) ‚Äî total ~30‚Äô"},
      {w:4,  label:"5√ó (4' course / 2' marche) ‚Äî total ~30‚Äô"},
      {w:5,  label:"4√ó (6' course / 2' marche) ‚Äî total ~32‚Äô"},
      {w:6,  label:"3√ó (8' course / 2' marche) ‚Äî total ~30‚Äô"},
      {w:7,  label:"2√ó (12' course / 2' marche) ‚Äî total ~28‚Äô"},
      {w:8,  label:"20' course continue (si OK) ‚Äî sinon 2√ó10'"},
      {w:9,  label:"25' course continue"},
      {w:10, label:"30' course continue ‚úÖ"}
    ];
    const planB = [
      {w:1,  label:"8√ó (1' course / 2' marche) ‚Äî total ~24‚Äô"},
      {w:2,  label:"7√ó (1'30 course / 2' marche) ‚Äî total ~24‚Äô"},
      {w:3,  label:"6√ó (2' course / 2' marche) ‚Äî total ~24‚Äô"},
      {w:4,  label:"6√ó (2'30 course / 2' marche) ‚Äî total ~27‚Äô"},
      {w:5,  label:"6√ó (3' course / 2' marche) ‚Äî total ~30‚Äô"},
      {w:6,  label:"5√ó (4' course / 2' marche) ‚Äî total ~30‚Äô"},
      {w:7,  label:"4√ó (5' course / 2' marche) ‚Äî total ~28‚Äô"},
      {w:8,  label:"3√ó (7' course / 2' marche) ‚Äî total ~27‚Äô"},
      {w:9,  label:"2√ó (12' course / 2' marche) ‚Äî total ~28‚Äô"},
      {w:10, label:"20' course continue (si OK)"},
      {w:11, label:"25' course continue"},
      {w:12, label:"30' course continue ‚úÖ"}
    ];

    function getWeekNumber(d){
      const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
      const dayNum = date.getUTCDay() || 7;
      date.setUTCDate(date.getUTCDate() + 4 - dayNum);
      const yearStart = new Date(Date.UTC(date.getUTCFullYear(),0,1));
      return Math.ceil((((date - yearStart)/86400000)+1)/7);
    }

    /* =========================
       RENDER: TODAY
    ========================= */
    function renderToday(){
      const root = document.getElementById("today");
      const today = new Date();
      const dateStr = fmtDate(today);
      const st = getDaily(dateStr);
      const goals = store.get("goals", defaultGoals);

      const ram = DATA.ramadanSchedule.find(x=>x.date===dateStr);

      const mealHint = ram
        ? `Ramadan : Suhoor conseill√© 30‚Äì45 min avant Fajr (${ram.fajr}). Iftar √† Maghrib (${ram.maghrib}).`
        : `Hors Ramadan : Petit-d√©j + d√©jeuner + d√Æner (prot√©ines + l√©gumes). Collation possible si entra√Ænement.`;

      root.innerHTML = `
        <div class="card">
          <div class="row">
            <div>
              <div class="h">Semaine ${getWeekNumber(today)} ‚Äî ${getPhase()}</div>
              <div class="small">Programme : ${getOrientation()}</div>
            </div>
            <div class="small" style="text-align:right;">
              Date : <b>${dateStr}</b><br/>
              Mode : <b>${goals.mode}</b> (A = plus vite, B = plus doux)
            </div>
          </div>
          <div class="small" style="margin-top:10px;">${mealHint}</div>
        </div>

        <div class="card">
          <div class="h">Check-list du jour</div>

          <div class="check">
            <input type="checkbox" id="${dateStr}-hydratation" ${st.hydration ? "checked":""}>
            <label for="${dateStr}-hydratation">Hydratation</label>
          </div>

          <div class="check">
            <input type="checkbox" id="${dateStr}-course" ${st.course ? "checked":""}>
            <label for="${dateStr}-course">${ram ? "Footing apr√®s Iftar (si pr√©vu)" : "Course / Marche"}</label>
          </div>

          <div class="check">
            <input type="checkbox" id="${dateStr}-renfo" ${st.renfo ? "checked":""}>
            <label for="${dateStr}-renfo">Renforcement genou</label>
          </div>

          <div class="small" style="margin-top:10px;">
            Repas (rappel rapide) :
            <br>‚Ä¢ <b>Hors Ramadan</b> : petit-d√©j / d√©jeuner / d√Æner (prot√©ines + l√©gumes) + eau.
            <br>‚Ä¢ <b>Ramadan</b> : Suhoor (prot√©ines + eau + fibres) ‚Ä¢ Iftar (eau + dattes/soupe + prot√©ines) ‚Ä¢ d√Æner l√©ger.
          </div>
        </div>

        <div class="card">
          <div class="h">Sortie</div>
          <div class="grid">
            <div>
              <label>Minutes</label>
              <input id="${dateStr}-minutes" type="number" min="0" value="${st.minutes}">
            </div>
            <div>
              <label>Kilom√®tres</label>
              <input id="${dateStr}-km" type="number" min="0" step="0.1" value="${st.km}">
            </div>
            <div>
              <label>Douleur genou (0‚Äì10)</label>
              <input id="${dateStr}-knee" type="number" min="0" max="10" value="${st.knee}">
            </div>
          </div>

          <div style="margin-top:12px;">
            <label>Notes</label>
            <input id="${dateStr}-notes" type="text" value="${st.notes}" placeholder="Ex : fatigue, sommeil, allure, m√©t√©o...">
          </div>

          <div id="kneeWarn" class="warn" style="display:none;">
            ‚ö†Ô∏è Douleur genou √©lev√©e : ralentir + privil√©gier marche / renfo doux.
          </div>
        </div>

        <div class="card">
          <div class="h">Renforcement (genou sensible) ‚Äî r√©f√©rence</div>
          <div class="small">2√ó/semaine (ou 1√ó pendant Ramadan si fatigue).</div>
          <div style="margin-top:12px; overflow:auto;">
            <table>
              <thead>
                <tr><th>Exercice</th><th>S√©ries √ó R√©p√©titions</th></tr>
              </thead>
              <tbody>
                ${DATA.strengthKneeFriendly.map(x=>`
                  <tr><td>${x.name}</td><td>${x.sets} √ó ${x.reps}</td></tr>
                `).join("")}
              </tbody>
            </table>
          </div>
        </div>
      `;

      // listeners (save)
      const cbHyd = document.getElementById(`${dateStr}-hydratation`);
      const cbCourse = document.getElementById(`${dateStr}-course`);
      const cbRenfo = document.getElementById(`${dateStr}-renfo`);
      const inMin = document.getElementById(`${dateStr}-minutes`);
      const inKm = document.getElementById(`${dateStr}-km`);
      const inKnee = document.getElementById(`${dateStr}-knee`);
      const inNotes = document.getElementById(`${dateStr}-notes`);
      const warn = document.getElementById("kneeWarn");

      function save(){
        const s = getDaily(dateStr);
        s.hydration = cbHyd.checked;
        s.course = cbCourse.checked;
        s.renfo = cbRenfo.checked;
        s.minutes = inMin.value;
        s.km = inKm.value;
        s.knee = inKnee.value;
        s.notes = inNotes.value;
        setDaily(dateStr, s);

        const k = parseFloat(s.knee);
        const goals = store.get("goals", defaultGoals);
        if(!isNaN(k) && k >= goals.kneeAlert) warn.style.display = "block";
        else warn.style.display = "none";
      }

      [cbHyd, cbCourse, cbRenfo, inMin, inKm, inKnee, inNotes].forEach(el=>{
        el.addEventListener("change", save);
        el.addEventListener("input", save);
      });

      // initial warn
      (function(){
        const k = parseFloat(st.knee);
        const goals = store.get("goals", defaultGoals);
        if(!isNaN(k) && k >= goals.kneeAlert) warn.style.display = "block";
      })();
    }

    /* =========================
       RENDER: LOG
    ========================= */
    function renderLog(){
      const root = document.getElementById("log");
      const all = store.get("daily", {});
      const rows = Object.entries(all).sort((a,b)=>a[0].localeCompare(b[0])).reverse().slice(0, 120);

      root.innerHTML = `
        <div class="card">
          <div class="h">Journal</div>
          <div class="small">Tes 120 derni√®res entr√©es (sauvegarde locale sur ton iPhone).</div>
        </div>

        <div class="card" style="overflow:auto;">
          <table>
            <thead>
              <tr>
                <th>Date</th><th>Minutes</th><th>Km</th><th>Genou</th><th>Check</th><th>Notes</th>
              </tr>
            </thead>
            <tbody>
              ${rows.map(([d,st])=>{
                const chk = [
                  st.hydration ? "üíß" : "‚Äî",
                  st.course ? "üèÉ" : "‚Äî",
                  st.renfo ? "ü¶µ" : "‚Äî"
                ].join(" ");
                return `
                  <tr>
                    <td><b>${d}</b></td>
                    <td>${st.minutes || ""}</td>
                    <td>${st.km || ""}</td>
                    <td>${st.knee || ""}</td>
                    <td>${chk}</td>
                    <td>${(st.notes || "").replaceAll("<","&lt;").replaceAll(">","&gt;")}</td>
                  </tr>
                `;
              }).join("")}
            </tbody>
          </table>
        </div>
      `;
    }

    /* =========================
       RENDER: PROGRAM
    ========================= */
    function renderProgram(){
      const root = document.getElementById("program");
      const goals = store.get("goals", defaultGoals);
      const plan = goals.mode === "A" ? planA : planB;

      root.innerHTML = `
        <div class="card">
          <div class="h">Programme 2026 (simple et efficace)</div>
          <div class="small">
            Objectif : passer progressivement de marche/course ‚Üí <b>courir 30 minutes sans marche</b>, puis construire vers <b>10 km</b>.
            <br>Mode actuel : <b>${goals.mode}</b>.
          </div>

          <div class="pillrow">
            <button class="pill ${goals.mode==="A"?"active":""}" id="modeA">Mode A (plus vite)</button>
            <button class="pill ${goals.mode==="B"?"active":""}" id="modeB">Mode B (plus doux)</button>
          </div>
        </div>

        <div class="card">
          <div class="h">Bloc ‚ÄúMarche ‚Üí Course‚Äù (jusqu‚Äô√† course continue)</div>
          <div class="small">2 s√©ances/semaine au d√©part. Si tout est OK (douleur genou faible), tu passes √† 3 s√©ances.</div>

          <div style="margin-top:12px; overflow:auto;">
            <table>
              <thead><tr><th>Semaine</th><th>Contenu s√©ance (exemple)</th></tr></thead>
              <tbody>
                ${plan.map(x=>`<tr><td><b>S${x.w}</b></td><td>${x.label}</td></tr>`).join("")}
              </tbody>
            </table>
          </div>

          <div class="small" style="margin-top:12px;">
            R√®gle : si le genou monte (douleur ‚â• seuil), tu r√©p√®tes la semaine au lieu d‚Äôaugmenter.
          </div>
        </div>

        <div class="card">
          <div class="h">Phases cl√©s 2026</div>
          <div class="small">
            ‚Ä¢ <b>Reprise</b> : r√©gularit√© + genou (2 s√©ances).<br>
            ‚Ä¢ <b>Ramadan (19/02 ‚Üí 20/03)</b> : sorties uniquement apr√®s Iftar, volume r√©duit.<br>
            ‚Ä¢ <b>Post-Ramadan</b> : retour progressif (2‚Äì3 s√©ances).<br>
            ‚Ä¢ <b>Base endurance</b> : construire un socle (mai‚Üíao√ªt).<br>
            ‚Ä¢ <b>Objectif 10 km</b> : septembre‚Üínovembre (allure + sortie longue).<br>
            ‚Ä¢ <b>Entretien</b> : d√©cembre.
          </div>
        </div>
      `;

      document.getElementById("modeA").onclick = ()=>{
        const g = store.get("goals", defaultGoals); g.mode="A"; store.set("goals", g); renderProgram();
      };
      document.getElementById("modeB").onclick = ()=>{
        const g = store.get("goals", defaultGoals); g.mode="B"; store.set("goals", g); renderProgram();
      };
    }

    /* =========================
       RENDER: RAMADAN
    ========================= */
    function renderRamadan(){
      const root = document.getElementById("ramadan");

      root.innerHTML = `
        <div class="card">
          <div class="h">Ramadan 2026 ‚Äî horaires (Melesse 35520)</div>
          <div class="small">
            ‚Ä¢ Suhoor : id√©alement <b>30‚Äì45 min avant Fajr</b><br>
            ‚Ä¢ Iftar : √† <b>Maghrib</b> (hydratation + repas structur√©)<br>
            ‚Ä¢ Entra√Ænement : <b>apr√®s Iftar</b> (footing doux) + renfo l√©ger si possible
          </div>
        </div>

        <div class="card">
          <div class="h">Repas ‚Äî r√®gles simples</div>
          <div class="small">
            <b>Suhoor</b> : prot√©ines + fibres + eau (√©vite sucre rapide seul).<br>
            <b>Iftar</b> : eau + dattes/soupe + prot√©ines + l√©gumes (garde du simple).<br>
            <b>D√Æner</b> : l√©ger si tu as d√©j√† mang√© √† Iftar. Hydratation jusqu‚Äôau coucher.
          </div>
        </div>

        <div class="card" style="overflow:auto;">
          <table>
            <thead>
              <tr><th>Jour</th><th>Date</th><th>Fajr (Suhoor)</th><th>Maghrib (Iftar)</th><th>Dur√©e je√ªne</th></tr>
            </thead>
            <tbody>
              ${DATA.ramadanSchedule.map(r=>`
                <tr>
                  <td><b>${r.day}</b></td>
                  <td>${r.date}</td>
                  <td>${r.fajr}</td>
                  <td>${r.maghrib}</td>
                  <td>${r.fasting}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
      `;
    }

    /* =========================
       RENDER: SETTINGS
    ========================= */
    function renderSettings(){
      const root = document.getElementById("settings");
      const g = store.get("goals", defaultGoals);

      root.innerHTML = `
        <div class="card">
          <div class="h">Objectifs hebdomadaires</div>
          <div class="small">Tu ajustes ici. L‚Äôalerte genou sert √† te prot√©ger.</div>

          <div class="grid">
            <div>
              <label>Objectif km / semaine</label>
              <input id="g_km" type="number" min="0" value="${g.km}">
            </div>
            <div>
              <label>Objectif minutes / semaine</label>
              <input id="g_min" type="number" min="0" value="${g.min}">
            </div>
            <div>
              <label>Objectif sorties / semaine</label>
              <input id="g_runs" type="number" min="0" value="${g.runs}">
            </div>
            <div>
              <label>Seuil alerte genou (0‚Äì10)</label>
              <input id="g_knee" type="number" min="0" max="10" value="${g.kneeAlert}">
            </div>
          </div>

          <div class="pillrow">
            <button class="pill ${g.mode==="A"?"active":""}" id="setA">Mode A</button>
            <button class="pill ${g.mode==="B"?"active":""}" id="setB">Mode B</button>
          </div>

          <div class="small" style="margin-top:12px;">
            Conseil : si tu veux ‚Äúaller plus vite‚Äù, passe en <b>Mode A</b> mais uniquement si douleur genou basse.
          </div>
        </div>

        <div class="card">
          <div class="h">Repas hors Ramadan (rappel simple)</div>
          <div class="small">
            ‚Ä¢ Petit-d√©j : prot√©ines + fibres<br>
            ‚Ä¢ D√©jeuner : prot√©ines + l√©gumes + f√©culents si sport<br>
            ‚Ä¢ D√Æner : prot√©ines + l√©gumes (plus l√©ger si tard)<br>
            ‚Ä¢ Hydratation r√©guli√®re
          </div>
        </div>
      `;

      const save = ()=>{
        const gg = store.get("goals", defaultGoals);
        gg.km = Number(document.getElementById("g_km").value || 0);
        gg.min = Number(document.getElementById("g_min").value || 0);
        gg.runs = Number(document.getElementById("g_runs").value || 0);
        gg.kneeAlert = Number(document.getElementById("g_knee").value || 0);
        store.set("goals", gg);
      };

      ["g_km","g_min","g_runs","g_knee"].forEach(id=>{
        document.getElementById(id).addEventListener("input", save);
        document.getElementById(id).addEventListener("change", save);
      });

      document.getElementById("setA").onclick = ()=>{ const gg=store.get("goals", defaultGoals); gg.mode="A"; store.set("goals", gg); renderSettings(); };
      document.getElementById("setB").onclick = ()=>{ const gg=store.get("goals", defaultGoals); gg.mode="B"; store.set("goals", gg); renderSettings(); };
    }

    /* =========================
       NAV
    ========================= */
    function show(tabId){
      document.querySelectorAll(".tab").forEach(b=>b.classList.remove("active"));
      document.querySelector(`.tab[data-tab="${tabId}"]`).classList.add("active");
      document.querySelectorAll(".panel").forEach(p=>p.style.display="none");
      document.getElementById(tabId).style.display="block";

      if(tabId==="today") renderToday();
      if(tabId==="log") renderLog();
      if(tabId==="program") renderProgram();
      if(tabId==="ramadan") renderRamadan();
      if(tabId==="settings") renderSettings();
    }
    document.querySelectorAll(".tab").forEach(btn=>{
      btn.addEventListener("click", ()=>show(btn.dataset.tab));
    });

    /* =========================
       THEME
    ========================= */
    function toggleTheme(){
      const cur = document.documentElement.getAttribute("data-theme") || "light";
      const next = (cur==="dark") ? "light" : "dark";
      document.documentElement.setAttribute("data-theme", next);
      store.set("theme", next);
    }

    /* INIT */
    show("today");
  </script>
</body>
</html>
